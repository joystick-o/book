# 1장 오브젝트와 의존관계

## 1.4 제어의 역전

### 오브젝트 팩토리

객체의 생성을 결정하고 그렇게 만들어진 오브젝트를 돌려주는 역할을 하는 오브젝트를 팩토리 라고 부른다.

```java
// UserDao의 생성 책임을 맡은 팩토리 클래스
public class DaoFactory {
    public UserDao userDao() {
        ConnectionMaker connectionMaker = new DConnectMaker();
        UserDao userDao = new UserDao(connectionMaker);
        return userDao;
    }
}
```

DaoFactory의 userDao 메소드를 호출하면 DConnectionMaker를 사용해 DB 커넥션을 가져오도록 이미 설정된 UserDao 오브젝트를 돌려준다.  
UserDaoTest는 이제 UserDao가 어떻게 만들어지는지 어떻게 초기화되어 있는지에 신경 쓰지 않고 팩토리로부터 UserDao 오브젝트를 받아다가 활용하면 된다.

```java
// 팩토리를 사용하도록 수정한 UserDaoTest
public class UserDaoTest {
    public static void main(String[] args) throw ClassNotFoundException,
           SQLException {
        UserDao dao = new DaoFactory().userDao();
    }
}
```

### 팩토리의 활용

```java
public class DaoFactory {
    public UserDao userDao() {
        return new UserDao(connectionMaker());
    }
    
    public AccountDao accountDao() {
        return new AccountDao(connectionMaker());
    }
    
    public MessageDao messageDao() {
        return new MessageDao(connectionMaker());
    }
    
    public ConnectionMaker connectionMaker() {
        return new new DConnectMaker();
    }
}
```

### 제어권의 이전을 통한 제어관계 역전

제어의 역전은 간단히 프로그램의 제어 흐름 구조가 뒤바뀌는 것이라고 설명할 수 있다.

